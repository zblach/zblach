<html>
	<head>
		<title> TimeGoose </title>
	</head>
	<script>
		const urlParams = new URLSearchParams(window.location.search);
		const time = urlParams.get('t') || 60;

		const good = Math.floor(time * 0.6);
		const warn = Math.floor(time * 0.2);

		var remaining = time;

		var x = setInterval(function() {
			remaining -= 1;
			var stamp = "";
			var bgcolor = "";
			
			// Background color			
			if (remaining > good) {
				bgcolor = "lightgreen";
			} else if (remaining > warn) {
				bgcolor = "yellow";
			} else if (remaining > 0) {
				bgcolor = "orange";
			} else {
				bgcolor = "red";
			}

			document.body.style.backgroundColor = bgcolor;

			// Image
			if (remaining > warn) {
				src = "./okay.png"
			} else if (remaining > 0) {
				src = "./warn.png";
			} else {
				src = "./angry.png"
			}

			document.getElementById('pic').src = src;

			// Timestamp
			if (remaining <= 0) {
				stamp = "HONK!!";
			} else {
				var seconds = remaining % 60;
				var minutes = Math.floor(remaining / 60);

				stamp = minutes + ":" + String(seconds).padStart(2, 0);
			}
			document.getElementById('timer').innerHTML = stamp;

		}, 1000);
	</script>
	<body>
		<p id='timer'></p>
		<img id='pic' />
	</body>
</html>
